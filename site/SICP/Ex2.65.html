<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smatchcube | Exercise 2.65</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>body {max-width: 1000px;padding: 15px; margin: auto;}</style>
<style>
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
</head>
<body>
<header>
  <h1>Smatchcube's website</h1>
  <hr>
</header>
<nav>
<p>/<a href="../index.html">home</a>/<a href="../SICP.html">SICP</a>/Exercise 2.65</p>
</nav>
<main>
<div id="header">
<h1 class="title">Exercise 2.65</h1>
</div>
<p>My solution is to transform trees in ordered lists, apply reunion or intersection and then transform the ordered list in the tree format. As we already wrote theses procedures this is straightforward, theses procedures are all \((n)\) so <code>union-set</code> and <code>intersection-set</code> are also \((n)\).</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(union-set set1 set2)
  (<span class="kw">define</span><span class="fu"> </span>(union-set-list set1 set2)
    (<span class="kw">cond</span> ((<span class="kw">null?</span> set1) set2)
          ((<span class="kw">null?</span> set2) set1)
          (<span class="kw">else</span> (<span class="kw">let</span> ((x1 (<span class="kw">car</span> set1))
                      (x2 (<span class="kw">car</span> set2)))
                  (<span class="kw">cond</span> ((<span class="kw">=</span> x1 x2) (<span class="kw">cons</span> x1 (union-set-list (<span class="kw">cdr</span> set1) (<span class="kw">cdr</span> set2))))
                        ((<span class="kw">&lt;</span> x1 x2) (<span class="kw">cons</span> x1 (union-set-list (<span class="kw">cdr</span> set1) set2)))
                        (<span class="kw">else</span> (<span class="kw">cons</span> x2 (union-set-list set1 (<span class="kw">cdr</span> set2)))))))))
  (list-&gt;tree (union-set-list (tree-&gt;list<span class="dv">-2</span> set1)
                              (tree-&gt;list<span class="dv">-2</span> set2))))

(<span class="kw">define</span><span class="fu"> </span>(intersection-set set1 set2)
  (<span class="kw">define</span><span class="fu"> </span>(intersection-set-list set1 set2)
    (<span class="kw">if</span> (<span class="kw">or</span> (<span class="kw">null?</span> set1) (<span class="kw">null?</span> set2))
        &#39;()
        (<span class="kw">let</span> ((x1 (<span class="kw">car</span> set1)) (x2 (<span class="kw">car</span> set2)))
          (<span class="kw">cond</span> ((<span class="kw">=</span> x1 x2)
                 (<span class="kw">cons</span> x1 (intersection-set-list (<span class="kw">cdr</span> set1)
                                            (<span class="kw">cdr</span> set2))))
                ((<span class="kw">&lt;</span> x1 x2)
                 (intersection-set-list (<span class="kw">cdr</span> set1) set2))
                ((<span class="kw">&lt;</span> x2 x1)
                 (intersection-set-list set1 (<span class="kw">cdr</span> set2)))))))
  (list-&gt;tree (intersection-set-list (tree-&gt;list<span class="dv">-2</span> set1)
                                     (tree-&gt;list<span class="dv">-2</span> set2))))</code></pre></div>
</main>
<footer>
<hr>
<!--<a href="http://www.w3.org/html/logo/">
<img src="https://www.w3.org/html/logo/downloads/HTML5_1Color_Black.svg" width="63" height="64" alt="HTML5 Powered" title="HTML5 Powered">
</a>-->
</footer>
</body>
</html>
